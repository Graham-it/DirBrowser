;Dir Browser
;common settings

;version 1.07
;released on 14/8/2025

;Copyright (c) 2025 Francesco Gramignani "Graham"
;https://graham-it.itch.io/dirbrowser

; --------------------
; - Program options
; --------------------

!if target = 20 {
;always enabled options
	wholeline = 1

;not available options
	getsize = 0
	romscroll = 0

} else {
;not available options
	vicmemcfg = 0
}

!if target = 64 {
;not available options
	romscroll = 0

} else {
;not available options
	fastload = 0
	kernalold = 0
}

!if vicmemcfg != 8 {
;not available options
	cartsupport = 0
}

; --------------------
; - Const values
; --------------------

firstdev = 8		;device address range
lastdev = 15

filenum = 1		;file number for disk operations
cmdchan = 15		;command channel
cmdlen = 3		;length for "cd:" or "xt:" command

namelen = 16		;max length for disk and file name
typelen = 3		;file type/extension length
sizelen = 5		;file size ASCII length (max size = 65535)
diskidlen = 5		;disk id length

entrylen = namelen+1+getsize*2			;stored entry length: name[16] + type[1] + size[2] (optional)
diskinfolen = namelen+getdiskid*diskidlen	;disk info length: name[16] + id[5] (optional)

!if cachemem {
tbldata = 2+rememberpos*(2+1+sortenable)	;prev table data
tblhdr = tbldata+getdiskinfo*diskinfolen	;table header (prev table data + disk info)

} else {
	tblhdr = getdiskinfo*diskinfolen	;table header (disk info)
}

!if joyenable {
	firstdelay = 16		;first repeat delay
	repeatdelay = 3		;next repeat delay
}

!if rightalign {
	exp16 = 144		;exponent for 16-bit values
	nodigits = 247		;decimal point position (with no digits)
}

!if searchenable {
	jumpsize = listrows*2	;max distance before jump
}

!if rasterbar {
	rowheight = 8		;row height

!if target = 20 {
	topraster = 76		;top border raster line
}

!if target = 64 | target = 128 {
	topraster = 50		;top border raster line
	waitraster = 10		;bad line alignment
}

!if target = 264 {
	topraster = 3		;top border raster line
}
}

; --------------------
; - Screen setup
; --------------------

;Screen size
!if target = 20 {
	screenrows = 23
	screencols = 22

} else {
	screenrows = 25
	screencols = 40		;(also for C128 in 80-column mode)
}

listwidth = namelen+list_tab+typelen+getsize*(list_tab+sizelen)		;list width
listtop = (statusenable|getdiskinfo|aboutenable)+printbars		;top row
listbot = screenrows-1-printbars-printbuttons*2				;bottom row

listrows = listbot-listtop+1			;max entries shown on screen
listpos = (screencols-listwidth)/2		;start column (centered)
listend = listpos+listwidth-1			;last column of list

typepos = listpos+namelen+list_tab		;type column

!if getsize {
	sizepos = typepos+typelen+list_tab	;size column
}

!if statusenable | getdiskinfo | aboutenable {
	status_row = 0				;status row
}

!if statusenable {
	status_pos = listpos			;status column
}

!if getdiskinfo {
	diskname_pos = listpos			;disk name column

!if getdiskid {
!if getsize {
	diskid_pos = sizepos			;disk id column

} else {
	diskid_pos = diskname_pos+namelen+1	;disk id column
}
}

!if counterenable {
	counter_pos = typepos			;entries number column
}
}

; --------------------
; - Screen colors
; --------------------

!if colorenable {
!if target = 20 {
;Merge VIC colors
	VIC_colors = back_col*16+8+border_col

!if rasterbar {
	VIC_raster = raster_col*16+8+border_col
}
}

;ASCII color codes
!ifdef list_col		list_acol	= ASCCOL [$0f & list_col]
!ifdef about_col 	about_acol	= ASCCOL [$0f & about_col]
!ifdef shadow_col	shadow_acol	= ASCCOL [$0f & shadow_col]
!ifdef diskinfo_col	diskinfo_acol	= ASCCOL [$0f & diskinfo_col]
!ifdef bar_col		bar_acol	= ASCCOL [$0f & bar_col]
!ifdef button_col	button_acol	= ASCCOL [$0f & button_col]
!ifdef active_col	active_acol	= ASCCOL [$0f & active_col]
!ifdef status_col	status_acol	= ASCCOL [$0f & status_col]
}

; --------------------
; - User buttons
; --------------------

!if printbuttons {
	button_row = listbot+printbars+1
	button_pos = listpos-1
	button_len = 8

!if target = 20 {
	slot_2 = button_pos+button_len
	slot_3 = button_pos+button_len*2-1

} else {
	slot_1 = button_pos+button_len
	slot_2 = button_pos+button_len*2
	slot_3 = button_pos+button_len*3-1
}
}
;printbuttons

; --------------------
; - Keyboard input
; --------------------

preve_key	= CRSR_up		;prev entry
nexte_key	= CRSR_down		;next entry
prevp_key	= CRSR_left		;prev page (or top of page)
nextp_key	= CRSR_right		;next page (or bottom of page)
top_key		= HOME_char		;top of list
bot_key		= SHIFT+HOME_char	;bottom of list
back_key	= DEL_char		;parent dir (or exit from disk image)
root_key	= SHIFT+DEL_char	;root dir
load_key	= RETURN_char		;select entry (not relocated load address)
reload_key	= '$'			;reload dir

!if addressmode {
	loadbas_key	= SHIFT+RETURN_char	;select entry (BASIC relocated load address)
}

!if target = 20 | target = 64 {
	quit_key2	= left_arrow	;quit to basic (alternate)

} else {
	quit_key2	= ESC_char	;quit to basic (alternate)
}

; --------------------
; - Function keys
; --------------------

!if devchange {
	device_key	= F1_char	;change device
}

!if target = 264 {
	reload_key2	= F2_char	;reload dir (alternate)

!if sortenable {
	sort_key	= F3_char	;sort mode
}

!if cachemem {
	cache_key	= F4_char	;cache mode
}

!if joyenable {
	joyswap_key	= F5_char	;joystick port
}

	quit_key	= F6_char	;quit to basic
	reset_key	= F7_char	;system reset

!if aboutenable {
	about_key	= HELP_char	;program info
}

} else {
!if cachemem {
	cache_key	= F2_char	;cache mode
}

!if target != 20 {
!if fastload {
	turbo_key	= F3_char	;fast load mode

} else {
	reload_key2	= F3_char	;reload dir (alternate)
}

!if joyenable {
	joyswap_key	= F4_char	;joystick port
}
}
;target != 20

!if sortenable {
	sort_key	= F5_char	;sort mode
}

	quit_key	= F6_char	;quit to basic

!if aboutenable {
	about_key	= F7_char	;program info

!if target = 128 {
	about_key2	= HELP_char	;program info (alternate)
}
}

	reset_key	= F8_char	;system reset
}

